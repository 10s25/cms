<script src="#CHEMIN{js/geolocalisation_10s25.js}"></script>
<style>
	dlg.geoloc {
		display: none;
	}

	.coords-ui {
		display: contents;
	}

	/* Mise en colonnes : 2/3 carte – 1/3 recherche */
	.geo-wrap{
		display:grid;
		grid-template-columns: 1fr 200px;
		gap:.5rem;
		align-items: stretch;
	}
	.leaflet-map{
		height: 600px;
		width: 600px;
		border:1px solid #ddd; border-radius:6px; box-shadow:0 1px 2px rgba(0,0,0,.05);
	}
	.geo-panel{ display:flex; flex-direction:column; min-height: 320px; }
	.geo-results{
		flex:1; overflow:auto;
		border:1px solid #ddd; border-radius:6px; background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.08);
	}
	.geo-results .hint{ padding:.5rem .75rem; color:#666 }
	.geo-results button {
		display:block; width:100%; text-align:left; padding:.5rem .75rem;
		border:0; background:#f5f5f5; cursor:pointer;
		color: #000000;
	}
	.geo-results button:hover{ background:#fdfd00 }

	/* Responsive : empile carte & recherche en dessous de 700px */
	@media (max-width: 700px){
		.geo-wrap{ grid-template-columns: 1fr; }
		.geo-panel{ min-height: auto; }
		.leaflet-map{ height: 600px; }
	}
</style>

<button id="geoloc_open_dlg" title="Géolocaliser[ (#OBJET|strtoupper)]" data-dlg="dlg-#OBJET-#ID_OBJET">Géolocaliser</button>
<dialog id="dlg-#OBJET-#ID_OBJET" class="dlg-geoloc">
	<div style="grid-column: span 2; display:flex; flex-direction:column; gap: 0.5em">
		<div class="coords-ui">
			<div class="geo-wrap" style="grid-column: span 2;">
				<!-- Carte à gauche -->
				<div id="map-#OBJET-#ID_OBJET"
						class="leaflet-map"
						data-lat=""
						data-lon="">
				</div>
		
				<!-- Panneau recherche à droite (lié à la bonne carte via data-map) -->
				<div class="geo-panel" data-map="map-#OBJET-#ID_OBJET">
					<small style="margin-top:.5rem; color:#666">
							Clique sur la carte, déplace le marqueur ou utilise la <b>recherche</b>:
					</small>
					<div class="geo-searchbar" style="display:flex; gap:.5em; margin-bottom:.5rem">
						<input class="geo-search" data-map="map-#OBJET-#ID_OBJET" value="[(#TITRE|attribut_html)]"
									type="search" placeholder="Rechercher une adresse ou un lieu…" style="flex:1">
					</div>
		
					<div class="geo-results" data-map="map-#OBJET-#ID_OBJET" hidden></div>

				</div>
			</div>
			<div style="grid-column: span 2; display:flex; flex-direction:row; gap: 0.5em">
				<label>Latitude</label>
				<input type="text" name="input_lat" value="">
				<br>
				<label>Longitude</label>
				<input type="text" name="input_lon" value="">
			</div>
		</div>
		<div align="right">
			<button class="close-all-dlg" type="button" value="Annuler" style="flex: 1;">Annuler</button>
			<button id="geoloc" type="submit" value="Geolocaliser" style="flex: 1;">Géolocaliser</button>
		</div>
	</div>
</dialog>
